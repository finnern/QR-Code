import qrcode
import sys
import os
from urllib.parse import urlparse

def create_qr_code(url):
    # Generate QR code
    qr = qrcode.QRCode(
        version=1,
        error_correction=qrcode.constants.ERROR_CORRECT_L,
        box_size=15,
        border=2,
    )
    qr.add_data(url)
    qr.make(fit=True)
    
    # Create an image from the QR Code instance
    img = qr.make_image(fill='black', back_color='white')
    
    # Derive a safe filename from the URL
    parsed_url = urlparse(url)
    filename = f"{parsed_url.netloc}{parsed_url.path}".replace('/', '_')
    if not filename:
        filename = "qr_code"
    filename += ".png"
    
    # Save the image
    img.save(filename)
    print(f"QR Code saved as {filename}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python create_qrcode.py <URL>")
        sys.exit(1)
    
    input_url = sys.argv[1]
    create_qr_code(input_url)
